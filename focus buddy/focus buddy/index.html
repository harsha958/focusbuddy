<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Buddy - Gamified Time Management</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Card Hover Effects */
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        /* Button Animations */
        .btn-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Progress Bar Animations */
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }

        /* Timer Circle Animation */
        .timer-circle {
            transition: stroke-dashoffset 1s linear;
        }

        /* Pet Animation */
        .pet-bounce {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Responsive Design */
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            
            .text-5xl {
                font-size: 2.5rem;
            }
            
            .text-6xl {
                font-size: 3rem;
            }
        }

        /* Focus States for Accessibility */
        button:focus,
        input:focus {
            outline: 2px solid #8b5cf6;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ============================================================================
        // ICON COMPONENTS
        // ============================================================================

        const Play = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="5,3 19,12 5,21"></polygon>
            </svg>
        );

        const Pause = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        );

        const RotateCcw = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="1,4 1,10 7,10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );

        const Award = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="8" r="7"></circle>
                <polyline points="8.21,13.89 7,23 12,20 17,23 15.79,13.88"></polyline>
            </svg>
        );

        const Clock = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12,6 12,12 16,14"></polyline>
            </svg>
        );

        const Zap = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
            </svg>
        );

        // ============================================================================
        // UTILITY FUNCTIONS
        // ============================================================================

        const formatTime = (seconds) => {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        };

        // ============================================================================
        // DATA CONSTANTS
        // ============================================================================

        const ANIMAL_STAGES = {
            cat: { 1: 'ðŸ¥š', 2: 'ðŸ±', 5: 'ðŸˆ', 10: 'ðŸˆâ€â¬›', 15: 'ðŸ¦' },
            dog: { 1: 'ðŸ¥š', 2: 'ðŸ¶', 5: 'ðŸ•', 10: 'ðŸ•â€ðŸ¦º', 15: 'ðŸº' },
            rabbit: { 1: 'ðŸ¥š', 2: 'ðŸ°', 5: 'ðŸ‡', 10: 'ðŸ°', 15: 'ðŸ¦˜' },
            bird: { 1: 'ðŸ¥š', 2: 'ðŸ£', 5: 'ðŸ¦', 10: 'ðŸ¦…', 15: 'ðŸ¦‰' },
            fish: { 1: 'ðŸ¥š', 2: 'ðŸ ', 5: 'ðŸŸ', 10: 'ðŸ¡', 15: 'ðŸ¦ˆ' }
        };

        const TASK_TYPES = {
            study: { name: 'Study', icon: 'ðŸ“š', xpMultiplier: 1.0 },
            work: { name: 'Work', icon: 'ðŸ’¼', xpMultiplier: 1.2 },
            creative: { name: 'Creative', icon: 'ðŸŽ¨', xpMultiplier: 1.1 },
            reading: { name: 'Reading', icon: 'ðŸ“–', xpMultiplier: 0.9 },
            coding: { name: 'Coding', icon: 'ðŸ’»', xpMultiplier: 1.3 },
            exercise: { name: 'Exercise', icon: 'ðŸƒ', xpMultiplier: 1.1 }
        };

        // ============================================================================
        // COMPONENTS
        // ============================================================================

        // Header Component
        const Header = ({ totalXP, currentStreak }) => (
            <div className="text-center mb-6 fade-in">
                <h1 className="text-3xl font-bold text-white mb-2">Focus Buddy</h1>
                <div className="flex justify-center gap-4 text-white">
                    <div className="flex items-center gap-1">
                        <Award />
                        <span>{totalXP} XP</span>
                    </div>
                    <div className="flex items-center gap-1">
                        <Zap />
                        <span>{currentStreak} streak</span>
                    </div>
                </div>
            </div>
        );

        // Pet Selection Component
        const PetSelection = ({ pets, selectedAnimal, setSelectedAnimal }) => {
            const getPetStage = (level, animalType) => {
                const stages = ANIMAL_STAGES[animalType];
                if (level <= 1) return stages[1];
                if (level <= 2) return stages[2];
                if (level <= 5) return stages[5];
                if (level <= 10) return stages[10];
                return stages[15];
            };

            return (
                <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Choose Your Pet</label>
                    <div className="grid grid-cols-3 gap-2">
                        {Object.entries(pets).map(([animal, pet]) => (
                            <button
                                key={animal}
                                onClick={() => setSelectedAnimal(animal)}
                                disabled={!pet.unlocked}
                                className={`p-3 rounded-lg border-2 transition-all card-hover ${
                                    selectedAnimal === animal
                                        ? 'border-purple-500 bg-purple-50'
                                        : pet.unlocked
                                        ? 'border-gray-200 hover:border-gray-300'
                                        : 'border-gray-100 opacity-50 cursor-not-allowed'
                                }`}
                            >
                                <div className="text-2xl mb-1">{getPetStage(pet.level, animal)}</div>
                                <div className="text-xs text-gray-600">{pet.name}</div>
                                {!pet.unlocked && (
                                    <div className="text-xs text-red-500 font-medium">Locked</div>
                                )}
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // Task Selection Component
        const TaskSelection = ({ currentTask, setCurrentTask }) => (
            <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Current Task</label>
                <div className="grid grid-cols-2 gap-2">
                    {Object.entries(TASK_TYPES).map(([task, info]) => (
                        <button
                            key={task}
                            onClick={() => setCurrentTask(task)}
                            className={`p-3 rounded-lg border-2 transition-all card-hover ${
                                currentTask === task
                                    ? 'border-blue-500 bg-blue-50'
                                    : 'border-gray-200 hover:border-gray-300'
                            }`}
                        >
                            <div className="text-lg mb-1">{info.icon}</div>
                            <div className="text-xs text-gray-600">{info.name}</div>
                            <div className="text-xs text-blue-500">Ã—{info.xpMultiplier}</div>
                        </button>
                    ))}
                </div>
            </div>
        );

        // Pet Display Component
        const PetDisplay = ({ pets, selectedAnimal, feedPet, playWithPet, totalXP }) => {
            const getPetStage = (level, animalType) => {
                const stages = ANIMAL_STAGES[animalType];
                if (level <= 1) return stages[1];
                if (level <= 2) return stages[2];
                if (level <= 5) return stages[5];
                if (level <= 10) return stages[10];
                return stages[15];
            };

            const getPetMood = (happiness) => {
                if (happiness >= 80) return 'ðŸ˜Š';
                if (happiness >= 60) return 'ðŸ˜';
                if (happiness >= 40) return 'ðŸ˜”';
                return 'ðŸ˜¢';
            };

            const currentPet = pets[selectedAnimal];

            return (
                <div className="bg-white rounded-2xl p-6 mb-6 shadow-lg card-hover">
                    <div className="text-center mb-4">
                        <div className="text-6xl mb-2 pet-bounce">{getPetStage(currentPet.level, selectedAnimal)}</div>
                        <div className="text-2xl mb-1">{getPetMood(currentPet.happiness)}</div>
                        <h2 className="text-xl font-semibold text-gray-800">{currentPet.name}</h2>
                        <p className="text-gray-600">Level {currentPet.level}</p>
                    </div>
                    
                    <div className="space-y-3">
                        <div>
                            <div className="flex justify-between text-sm text-gray-600 mb-1">
                                <span>Hunger</span>
                                <span>{currentPet.hunger}%</span>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-2">
                                <div 
                                    className="bg-orange-500 h-2 rounded-full progress-bar"
                                    style={{ width: `${currentPet.hunger}%` }}
                                ></div>
                            </div>
                        </div>
                        <div>
                            <div className="flex justify-between text-sm text-gray-600 mb-1">
                                <span>Happiness</span>
                                <span>{currentPet.happiness}%</span>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-2">
                                <div 
                                    className="bg-green-500 h-2 rounded-full progress-bar"
                                    style={{ width: `${currentPet.happiness}%` }}
                                ></div>
                            </div>
                        </div>
                    </div>

                    <div className="flex gap-2 mt-4">
                        <button
                            onClick={feedPet}
                            disabled={totalXP < 10}
                            className="flex-1 bg-orange-500 text-white py-2 px-4 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-orange-600 transition-colors"
                        >
                            Feed (10 XP)
                        </button>
                        <button
                            onClick={playWithPet}
                            disabled={totalXP < 15}
                            className="flex-1 bg-green-500 text-white py-2 px-4 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-green-600 transition-colors"
                        >
                            Play (15 XP)
                        </button>
                    </div>
                </div>
            );
        };

        // Timer Component
        const Timer = ({ 
            sessionLength, 
            timeLeft, 
            isActive, 
            currentTask, 
            updateSessionLength, 
            toggleTimer, 
            resetTimer 
        }) => (
            <div className="bg-white rounded-2xl p-6 mb-6 shadow-lg card-hover">
                <div className="mb-6">
                    <label className="block text-sm font-medium text-gray-700 mb-3">Focus Session Length</label>
                    <div className="flex gap-2 flex-wrap">
                        {[15, 25, 30, 45, 60, 90].map(minutes => (
                            <button
                                key={minutes}
                                onClick={() => updateSessionLength(minutes)}
                                disabled={isActive}
                                className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                                    sessionLength === minutes
                                        ? 'bg-purple-500 text-white'
                                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                } ${isActive ? 'opacity-50 cursor-not-allowed' : ''}`}
                            >
                                {minutes}m
                            </button>
                        ))}
                    </div>
                </div>

                <div className="text-center mb-6">
                    <div className="text-5xl font-mono font-bold text-gray-800 mb-2">
                        {formatTime(timeLeft)}
                    </div>
                    <div className="flex items-center justify-center gap-2 text-gray-600">
                        <Clock />
                        <span>{sessionLength}min {TASK_TYPES[currentTask].name} Session</span>
                    </div>
                </div>

                <div className="relative w-32 h-32 mx-auto mb-6">
                    <svg className="w-32 h-32 transform -rotate-90">
                        <circle cx="64" cy="64" r="56" stroke="#e5e7eb" strokeWidth="8" fill="none" />
                        <circle
                            cx="64"
                            cy="64"
                            r="56"
                            stroke="#8b5cf6"
                            strokeWidth="8"
                            fill="none"
                            strokeDasharray={`${2 * Math.PI * 56}`}
                            strokeDashoffset={`${2 * Math.PI * 56 * (timeLeft / (sessionLength * 60))}`}
                            className="timer-circle"
                        />
                    </svg>
                    <div className="absolute inset-0 flex items-center justify-center">
                        <span className="text-sm font-medium text-gray-600">
                            {Math.round(((sessionLength * 60 - timeLeft) / (sessionLength * 60)) * 100)}%
                        </span>
                    </div>
                </div>

                <div className="flex justify-center gap-4">
                    <button
                        onClick={toggleTimer}
                        className={`flex items-center gap-2 bg-purple-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-purple-600 transition-colors ${isActive ? 'btn-pulse' : ''}`}
                    >
                        {isActive ? <Pause /> : <Play />}
                        {isActive ? 'Pause' : 'Start'}
                    </button>
                    <button
                        onClick={resetTimer}
                        className="flex items-center gap-2 bg-gray-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-gray-600 transition-colors"
                    >
                        <RotateCcw />
                        Reset
                    </button>
                </div>
            </div>
        );

        // Stats Component
        const Stats = ({ sessions, sessionLength, totalXP }) => (
            <div className="bg-white rounded-2xl p-6 shadow-lg card-hover">
                <h3 className="text-lg font-semibold text-gray-800 mb-4">Today's Progress</h3>
                <div className="grid grid-cols-3 gap-4 text-center">
                    <div className="slide-up">
                        <div className="text-2xl font-bold text-purple-500">{sessions}</div>
                        <div className="text-sm text-gray-600">Sessions</div>
                    </div>
                    <div className="slide-up">
                        <div className="text-2xl font-bold text-pink-500">{Math.floor(sessions * sessionLength)}</div>
                        <div className="text-sm text-gray-600">Minutes</div>
                    </div>
                    <div className="slide-up">
                        <div className="text-2xl font-bold text-red-500">{totalXP}</div>
                        <div className="text-sm text-gray-600">Total XP</div>
                    </div>
                </div>
            </div>
        );

        // ============================================================================
        // MAIN APP COMPONENT
        // ============================================================================

        const FocusBuddy = () => {
            // State Management
            const [sessionLength, setSessionLength] = useState(25);
            const [timeLeft, setTimeLeft] = useState(25 * 60);
            const [isActive, setIsActive] = useState(false);
            const [totalXP, setTotalXP] = useState(0);
            const [currentStreak, setCurrentStreak] = useState(0);
            const [selectedAnimal, setSelectedAnimal] = useState('cat');
            const [currentTask, setCurrentTask] = useState('study');
            const [sessions, setSessions] = useState(0);
            
            const [pets, setPets] = useState({
                cat: { name: 'Whiskers', level: 1, hunger: 50, happiness: 70, unlocked: true },
                dog: { name: 'Buddy', level: 1, hunger: 50, happiness: 70, unlocked: false },
                rabbit: { name: 'Hoppy', level: 1, hunger: 50, happiness: 70, unlocked: false },
                bird: { name: 'Chirpy', level: 1, hunger: 50, happiness: 70, unlocked: false },
                fish: { name: 'Bubbles', level: 1, hunger: 50, happiness: 70, unlocked: false }
            });

            const intervalRef = useRef(null);

            // Utility Functions
            const unlockNewPet = (xpSpent) => {
                const unlockCosts = { dog: 100, rabbit: 200, bird: 300, fish: 400 };
                Object.keys(unlockCosts).forEach(animal => {
                    if (xpSpent >= unlockCosts[animal] && !pets[animal].unlocked) {
                        setPets(prev => ({
                            ...prev,
                            [animal]: { ...prev[animal], unlocked: true }
                        }));
                    }
                });
            };

            // Timer Logic
            useEffect(() => {
                if (isActive && timeLeft > 0) {
                    intervalRef.current = setInterval(() => {
                        setTimeLeft(timeLeft - 1);
                    }, 1000);
                } else if (timeLeft === 0 && isActive) {
                    const taskMultiplier = TASK_TYPES[currentTask].xpMultiplier;
                    const xpGained = Math.floor(sessionLength * 1.5 * taskMultiplier) + (currentStreak * 5);
                    setTotalXP(prev => prev + xpGained);
                    setSessions(prev => prev + 1);
                    setCurrentStreak(prev => prev + 1);
                    
                    setPets(prev => ({
                        ...prev,
                        [selectedAnimal]: {
                            ...prev[selectedAnimal],
                            hunger: Math.min(100, prev[selectedAnimal].hunger + Math.floor(sessionLength * 1.2)),
                            happiness: Math.min(100, prev[selectedAnimal].happiness + Math.floor(sessionLength * 0.8)),
                            level: Math.floor((totalXP + xpGained) / 100) + 1
                        }
                    }));
                    
                    unlockNewPet(totalXP + xpGained);
                    setIsActive(false);
                    setTimeLeft(sessionLength * 60);
                }
                return () => clearInterval(intervalRef.current);
            }, [isActive, timeLeft, totalXP, currentStreak, sessionLength, currentTask, selectedAnimal]);

            // Pet Decay System
            useEffect(() => {
                const decayInterval = setInterval(() => {
                    setPets(prev => {
                        const updated = { ...prev };
                        Object.keys(updated).forEach(animal => {
                            if (updated[animal].unlocked) {
                                updated[animal] = {
                                    ...updated[animal],
                                    hunger: Math.max(0, updated[animal].hunger - 1),
                                    happiness: Math.max(0, updated[animal].happiness - 0.5)
                                };
                            }
                        });
                        return updated;
                    });
                }, 30000);

                return () => clearInterval(decayInterval);
            }, []);

            // Event Handlers
            const toggleTimer = () => {
                setIsActive(!isActive);
            };

            const resetTimer = () => {
                setIsActive(false);
                setTimeLeft(sessionLength * 60);
                setCurrentStreak(0);
            };

            const updateSessionLength = (minutes) => {
                if (!isActive) {
                    setSessionLength(minutes);
                    setTimeLeft(minutes * 60);
                }
            };

            const feedPet = () => {
                if (totalXP >= 10) {
                    setTotalXP(prev => prev - 10);
                    setPets(prev => ({
                        ...prev,
                        [selectedAnimal]: {
                            ...prev[selectedAnimal],
                            hunger: Math.min(100, prev[selectedAnimal].hunger + 20),
                            happiness: Math.min(100, prev[selectedAnimal].happiness + 10)
                        }
                    }));
                }
            };

            const playWithPet = () => {
                if (totalXP >= 15) {
                    setTotalXP(prev => prev - 15);
                    setPets(prev => ({
                        ...prev,
                        [selectedAnimal]: {
                            ...prev[selectedAnimal],
                            happiness: Math.min(100, prev[selectedAnimal].happiness + 25)
                        }
                    }));
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 p-4">
                    <div className="max-w-md mx-auto">
                        <Header totalXP={totalXP} currentStreak={currentStreak} />
                        
                        {/* Animal & Task Selection */}
                        <div className="bg-white rounded-2xl p-6 mb-6 shadow-lg card-hover">
                            <div className="grid grid-cols-2 gap-4">
                                <PetSelection 
                                    pets={pets} 
                                    selectedAnimal={selectedAnimal} 
                                    setSelectedAnimal={setSelectedAnimal} 
                                />
                                <TaskSelection 
                                    currentTask={currentTask} 
                                    setCurrentTask={setCurrentTask} 
                                />
                            </div>
                        </div>

                        {/* Pet Display */}
                        <PetDisplay 
                            pets={pets} 
                            selectedAnimal={selectedAnimal} 
                            feedPet={feedPet} 
                            playWithPet={playWithPet} 
                            totalXP={totalXP} 
                        />

                        {/* Focus Timer */}
                        <Timer 
                            sessionLength={sessionLength}
                            timeLeft={timeLeft}
                            isActive={isActive}
                            currentTask={currentTask}
                            updateSessionLength={updateSessionLength}
                            toggleTimer={toggleTimer}
                            resetTimer={resetTimer}
                        />

                        {/* Stats */}
                        <Stats 
                            sessions={sessions} 
                            sessionLength={sessionLength} 
                            totalXP={totalXP} 
                        />
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<FocusBuddy />, document.getElementById('root'));
    </script>
</body>
</html> 